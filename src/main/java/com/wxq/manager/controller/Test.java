package com.wxq.manager.controller;import com.wxq.manager.entity.Book;import com.wxq.manager.entity.User;import com.wxq.manager.exception.UserNotFoundException;import com.wxq.manager.exception.UserNotLoginException;import java.util.ArrayList;import java.util.Scanner;import java.util.logging.Logger;public class Test {	private static final String HEADSTAR ="******************************->| ";	private static final String TAILSTAR =" |<-******************************";	private BookManager bm = BookManager.getInstance();	private Scanner scanner;	private String userName;	public Test() {		scanner = new Scanner(System.in);		userName = "";	}	public boolean initUser() {		System.out.print("\n"+HEADSTAR+"注册界面"+TAILSTAR+"\n输入你的名字：");		userName = scanner.next();		if (bm.isUserExist(userName)) {			System.out.println(userName + " 已经注册了，直接登录吧");			return false;		}		System.out.println("老师还是学生？(tea?stu)");		String userType = scanner.next();		while (!(userType.equals("stu") || userType.equals("tea"))) {			System.out.println("输入错误，(tea?stu)");			userType = scanner.next();		}		System.out.println(userName + " " + userType + "注册中...");		bm.registeUser(new User(userName, userType));		return true;	}	public boolean login() {		if (!bm.isAnyBodyElse()) {			System.out.println("欢迎第一位用户！先注册一下吧");			initUser();		}		if (bm.isAnyBodyElse()) {			System.out.print("\n1、登陆 2、注册\n请选择：");			String choose =scanner.next();			switch (choose) {				case "1":					bm.displayAllUsers();					System.out.println("\n请输入姓名：");					userName = scanner.next();					try {						bm.loginUser(userName);						return false;					} catch (UserNotFoundException userNotFoundException) {						System.out.println("登陆失败：查无此人\n");					}					break;				case "2":					initUser();					break;				default:					System.out.println("打错字啦\n");			}		}		return true;	}	public void showUserInformation() {		try {			bm.queryUserBorrowRecord(userName);			bm.payBookCost(userName);		} catch (UserNotLoginException e) {			Logger.getGlobal().info(e.getMessage());		}	}	public void display(){		bm.displayAllBooks();		bm.displayAllUsers();	}	public boolean borrowTest() {		bm.displayAllBooks();		System.out.print("\n请输入要借的图书id(Q退出)：");		String borrowBookId = scanner.next();		if (borrowBookId.equals("Q") || borrowBookId.equals("q")) {			System.out.println("下次再来哈~");			return false;		} else			try {				if (bm.borrowBook(userName, borrowBookId))					System.out.println(userName							+ "借阅了《"							+ bm.queryBookNameByBookId(borrowBookId)							+ "》");			} catch (UserNotLoginException e) {			}		return true;	}	public boolean addBook(){		System.out.println("\n是否添加图书\nY/N");		String whetherAdd = scanner.next();		switch (whetherAdd){			case "Y":			case "y":				//bm.addBookList();				ArrayList<String> temp = new ArrayList<>();				System.out.println("请输入书名");				temp.add(scanner.next());				System.out.println("请输入作者名");				temp.add(scanner.next());				System.out.println("请输入出版社");				temp.add(scanner.next());				//System.out.println(temp);				bm.addBook(new Book(1,temp.get(0),temp.get(1),temp.get(2)));			case "N":			case "n":				break;			default:				System.out.println("打错字啦\n");		}		return true;	}	public boolean returnTest() {		System.out.println("\n您的借阅记录如下：");		bm.queryUserBorrowRecord(userName);		System.out.print("\n请输入要还的图书id(Q退出)：");		String returnBookId = scanner.next();		if (returnBookId.equals("Q") || returnBookId.equals("q")) {			System.out.println("Bye~");			return false;		} else {			try {				if (bm.returnBook(userName, returnBookId)) {					System.out.println(userName + "归还了" + returnBookId);					bm.payBookCost(userName);				}			} catch (UserNotLoginException e) {			}		}		return true;	}	public void logOut() {		bm.logoutUser(userName);	}	public void getCurrentLibraryState() {		System.out.println("\n现在图书馆状态如下：");		bm.displayAllBooks();		bm.displayAllUsers();		bm.queryUserBorrowRecord(userName);	}	public static void main(String[] args) {		Test test = new Test();		System.out.println("\n"+Test.HEADSTAR+"欢迎进入图书馆！"+Test.TAILSTAR+"\n");		boolean flag = true;		while (flag) {			flag = test.login();		}		test.showUserInformation();		Scanner scanner = new Scanner(System.in);		String scaIn="";		do {			System.out.print("\n1.借书 2.还书 3.录入\n请输入(Q/q退出）:");			scaIn=scanner.next();			switch (scaIn){				case "1":					test.borrowTest();					break;				case "2":					test.returnTest();					break;				case "3":					test.addBook();					break;				case "q":				case "Q":break;				default:					System.out.println("打错字啦\n");			}		}while (!(scaIn.equals("q")||(scaIn.equals("Q"))));		test.logOut();	//	test.getCurrentLibraryState();	}}